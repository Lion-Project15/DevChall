<html layout:decorate="~{usr/member/layout.html}" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="UTF-8">
    <title>챌린지 생성 페이지</title>
</head>

<body>

<main layout:fragment="main" class="flex flex-col w-full">

    <script th:inline="javascript">

        function CreateForm__submit(form) {

            if (form.title.value.length > 25) {
                toastWarning('챌린지 제목은 25자 까지 가능합니다.');
                form.title.focus();
                console.log('제대로 됩니까?');
                return;
            }

            if (form.contents.value.length > 500) {
                toastWarning('챌린지 내용은 500자 까지 작성 가능합니다.');
                form.contents.focus();
                return;
            }

            var today = new Date();
            var selectedDate = new Date(form.startDate.value);

            if (selectedDate <= today) {
                toastWarning('챌린지 시작일은 오늘 이후로 설정해야 합니다.');
                form.startDate.focus();
                return;
            }

            var fileInput = document.getElementById('img');
            var fileName = fileInput.value;
            var allowedExtensions = /(\.jpg|\.jpeg|\.png|\.gif)$/i;

            if (!allowedExtensions.exec(fileName)) {
                toastWarning('첨부 파일의 확장자는 JPG, JPEG, PNG, GIF만 가능합니다.');
                fileInput.value = '';
                return;
            }

            form.submit(); // 폼 발송
        }
    </script>

    <!-- FIXME 챌린지별 사진으로 변경?-->
    <div class="flex items-center content-center h-screen">
        <form method="post" th:action="@{/usr/challenge/create}" enctype="multipart/form-data"
              class="flex flex-col items-center w-full" onsubmit="CreateForm__submit(this); return false;">
            <div class="w-full h-1/8"></div>
            <div class="card bg-white flex-1 justify-around content-around">
                <div class="flex flex-row  ml-14 mt-5">
                    <h1 class="text-[25px] font-black">챌린지 생성</h1>
                    <p class="ml-8 mt-2">원하는 챌린지를 생성해 보세요!</p>
                </div>

                <div class="w-1/2 p-5 lg:w-[65rem] flex flex-row justify-around content-around">
                    <div class="flex flex-col">
                        <label for="title" class="label">
                            <span class="text-gray-400">챌린지 제목</span>
                        </label>
                        <input type="text" name="title" maxlength="30" placeholder="챌린지명"
                               class="input input-bordered w-full form-control text-black input-accent" id="title"
                               style="border-color: #03FA6E;" autofocus/>

                        <label for="contents" class="label mt-3">
                            <span class="text-gray-400">챌린지 내용</span>
                        </label>
                        <textarea rows="6" name="contents" placeholder="챌린지내용"
                                  class="textarea textarea-accent w-full form-control text-black"
                                  style="border-color: #03FA6E;"
                                  id="contents"></textarea>

                        <div class="flex flex-col mt-3">
                            <label class="tag">
                                <span class="text-gray-400">챌린지 태그 설정</span>
                            </label>
                            <div class="flex flex-row gap-3">
                                <select name="language" class="select select-accent max-w-xs">
                                    <option disabled selected>공부하고 싶은 언어</option>
                                    <option>Java</option>
                                    <option>Ruby</option>
                                    <option>React</option>
                                    <option>Kotlin</option>
                                    <option>C</option>
                                    <option>C#</option>
                                    <option>C++</option>
                                    <option>JavaScript</option>
                                    <option>Python</option>
                                </select>

                                <select name="subject" class="select select-accent max-w-xs">
                                    <option disabled selected>공부 주제</option>
                                    <option value="project">프로젝트</option>
                                    <option value="coding">코딩테스트</option>
                                    <option value="algorithm">알고리즘</option>
                                    <option value="study">개념 공부</option>
                                    <option value="test">시험 대비</option>
                                    <option value="solving">예제 풀기</option>
                                </select>

                                <select name="posttype" class="select select-accent max-w-xs">
                                    <option disabled selected>인증 방식</option>
                                    <option>Github</option>
                                    <option>블로그</option>
                                    <option>IDE 캡처</option>
                                    <option>인증샷</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col">
                        <div class="flex flex-row gap-4">
                            <div class="flex-col">
                                <label class="label">
                                    <span class="text-gray-400">챌린지 시작일 선택</span>
                                </label>
                                <input type="date" name="startDate" class="text-black select select-accent"/>
                            </div>

                            <div class="flex-col">
                                <label class="label">
                                    <span class="text-gray-400">챌린지 기간 선택</span>
                                </label>
                                <select name="period" class="select select-accent w-70 max-w-xs">
                                    <option>2주</option>
                                    <option>3주</option>
                                    <option>4주</option>
                                    <option>6주</option>
                                    <option>8주</option>
                                    <option>12주</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="label mt-3 ml-10px">
                                <!-- 인증 주기 UI 재설정 필요-->
                                <span class="text-gray-400">인증 주기 선택</span>
                            </label>
                            <div class="flex flex-row justify-around">
                                <input type="radio" name="frequency" value="day1" class="radio radio-accent" checked>주 1회
                                <input type="radio" name="frequency" value="day3" class="radio radio-accent">주 3회
                                <input type="radio" name="frequency" value="day5" class="radio radio-accent">주 5회
                                <input type="radio" name="frequency" value="day7" class="radio radio-accent">매일
                            </div>
                        </div>

                        <div>
                            <label class="label mt-3 ml-8px">
                                <!-- 공개여부 UI 재설정 필요-->
                                <label class="label">
                                    <span class="text-gray-400">공개 여부</span>
                                </label>
                            </label>
                            <div class="flex flex-row justify-around">
                                <input type="radio" name="status" id="public" value=true class="radio radio-accent"
                                       checked>공개
                                <input type="radio" name="status" id="private" value=false
                                       class="radio radio-accent">비공개
                            </div>
                        </div>

                        <div class="mt-3">
                            <label for="img" class="label">
                                <span class="text-gray-400">챌린지 대표 이미지</span>
                            </label>
                            <input id="img" name="file" type="file"
                                   class="file-input file-input-bordered file-input-accent w-full max-w-xs justify-center"/>
                        </div>


                        <div class="flex flex-row justify-around mt-3">
                            <label for="my_modal_6" class="btn btn-md btn-warning gap-3">생성 규칙 보기</label>

                            <input type="checkbox" id="my_modal_6" class="w-1/3 modal-toggle modal-warning"/>
                            <div class="modal">
                                <div class="modal-box">
                                    <h3 class="font-bold text-lg">챌린지 생성 규칙</h3>
                                    <p class="py-4">1. 챌린지 제목은 중복될 수 없습니다.</p>
                                    <p class="py-4">2. 챌린지 제목은 25자 까지 작성 가능합니다.</p>
                                    <p class="py-4">3. 챌린지 내용은 500자 까지 작성 가능합니다.</p>
                                    <p class="py-4">4. 챌린지 시작일은 내일부터 지정 가능합니다.</p>
                                    <p class="py-4">5. 첨부 파일의 확장자 명은 JPG, JPEG, PNG, GIF 만 가능합니다.</p>
                                    <p class="py-4">6. 이미지가 첨부되지 않은 경우, 기본 이미지로 설정 됩니다.</p>
                                    <div class="modal-action">
                                        <label for="my_modal_6" class="btn btn-md">닫기 X</label>
                                    </div>
                                </div>
                            </div>

                            <input type="submit" value="생성완료" class="w-1/3 btn btn-md btn-success gap-3">
                        </div>

                    </div>

                </div>
            </div>
            <div class="w-full h-1/8"></div>
        </form>
    </div>
</main>

</body>

</html>